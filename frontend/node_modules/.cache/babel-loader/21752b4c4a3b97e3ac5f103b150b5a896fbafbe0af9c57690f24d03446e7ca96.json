{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/NontakornKhanaphol/Documents/Nontakorn-joe/Dev/Git-Lab/ccctv-ping/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/NontakornKhanaphol/Documents/Nontakorn-joe/Dev/Git-Lab/ccctv-ping/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/NontakornKhanaphol/Documents/Nontakorn-joe/Dev/Git-Lab/ccctv-ping/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import axios from'axios';import'../assets/cctv.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=function App(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),apiData=_useState2[0],setApiData=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),webSocketData=_useState4[0],setWebSocketData=_useState4[1];console.log(process.env.REACT_APP_HOST);// Fetch API data\nuseEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(process.env.REACT_APP_HOST+'/api/ping/check-cctv');case 3:response=_context.sent;setApiData(response.data);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.error('Error fetching data:',_context.t0);case 10:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();var intervalId=setInterval(fetchData,2000);// Refresh every 2 seconds\nreturn function(){return clearInterval(intervalId);};// Cleanup interval on unmount\n},[]);// Connect to WebSocket server\nuseEffect(function(){var ws=new WebSocket('ws://localhost:4000');console.log('WebSocket :',ws);ws.onclose=function(){console.log('WebSocket connection closed');};ws.onopen=function(){console.log('WebSocket connection opened');};if(ws.readyState===WebSocket.CLOSED){console.log('WebSocket connection closed before it was established');}return function(){ws.close();};},[]);useEffect(function(){var handleMessage=function handleMessage(event){var data=JSON.parse(event.data);setWebSocketData(data);// console.log('set :',data)\n};if(webSocketData){var ws=new WebSocket('ws://localhost:4000');ws.onmessage=handleMessage;return function(){ws.close();};}},[webSocketData]);return/*#__PURE__*/_jsxs(\"div\",{className:\"table-container\",children:[/*#__PURE__*/_jsx(\"img\",{src:require('../assets/jastel.jpg'),alt:\"Jastel Logo\"}),/*#__PURE__*/_jsxs(\"table\",{className:\"table1\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"TTH\",children:/*#__PURE__*/_jsx(\"tr\",{className:\"ab\",children:apiData&&apiData.data.map(function(room){return room.roomname!==\"SLG\"&&room.roomname!==\"HYI3\"&&room.roomname!==\"HYI4\"&&room.roomname!==\"OFFICE7\"&&room.roomname!==\"OFFICE6\"&&/*#__PURE__*/_jsx(\"th\",{className:\"room-name1\",children:room.roomname},room.roomname);})})}),/*#__PURE__*/_jsx(\"tbody\",{children:/*#__PURE__*/_jsx(\"tr\",{className:\"bb\",children:apiData&&apiData.data.map(function(room){return room.roomname!==\"SLG\"&&room.roomname!==\"HYI3\"&&room.roomname!==\"HYI4\"&&room.roomname!==\"OFFICE7\"&&room.roomname!==\"OFFICE6\"&&/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"table\",{className:\"table2\",children:/*#__PURE__*/_jsx(\"tbody\",{children:room.status.map(function(camera,index){return/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{className:\"status-cell \".concat(camera.camera==='ON'?'status-on':'status-off'),title:camera.ip,children:/*#__PURE__*/_jsx(\"a\",{href:\"http://\".concat(camera.ip),target:\"_blank\",rel:\"noopener noreferrer\",children:/*#__PURE__*/_jsx(\"div\",{children:camera.camera})})})},index);})})})},room.roomname);})})})]}),/*#__PURE__*/_jsx(\"table\",{className:\"table3\",children:/*#__PURE__*/_jsx(\"tbody\",{children:apiData&&apiData.data.filter(function(room){return[\"SLG\",\"HYI3\",\"HYI4\",\"OFFICE7\",\"OFFICE6\"].includes(room.roomname);}).map(function(room){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"room-name2\",children:room.roomname}),/*#__PURE__*/_jsx(\"td\",{className:\"room-status\",children:/*#__PURE__*/_jsx(\"table\",{className:\"table-4\",children:/*#__PURE__*/_jsx(\"tbody\",{children:/*#__PURE__*/_jsx(\"tr\",{children:room.status.map(function(camera,index){return/*#__PURE__*/_jsx(\"td\",{className:\"status-cell \".concat(camera.camera==='ON'?'status-on':'status-off'),title:camera.ip,children:/*#__PURE__*/_jsx(\"a\",{href:\"http://\".concat(camera.ip),target:\"_blank\",rel:\"noopener noreferrer\",children:/*#__PURE__*/_jsx(\"div\",{children:camera.camera})})},index);})})})})})]},room.roomname);})})})]});};export default App;","map":{"version":3,"names":["React","useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","App","_useState","_useState2","_slicedToArray","apiData","setApiData","_useState3","_useState4","webSocketData","setWebSocketData","console","log","process","env","REACT_APP_HOST","fetchData","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_callee$","_context","prev","next","get","sent","data","t0","error","stop","apply","arguments","intervalId","setInterval","clearInterval","ws","WebSocket","onclose","onopen","readyState","CLOSED","close","handleMessage","event","JSON","parse","onmessage","className","children","src","require","alt","map","room","roomname","status","camera","index","concat","title","ip","href","target","rel","filter","includes"],"sources":["C:/Users/NontakornKhanaphol/Documents/Nontakorn-joe/Dev/Git-Lab/ccctv-ping/frontend/src/pages/Home.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport '../assets/cctv.css';\n\nconst App = () => {\n  const [apiData, setApiData] = useState(null);\n  const [webSocketData, setWebSocketData] = useState(null);\n\n  console.log(process.env.REACT_APP_HOST);\n\n  // Fetch API data\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const response = await axios.get(process.env.REACT_APP_HOST + '/api/ping/check-cctv');\n        setApiData(response.data);\n      } catch (error) {\n        console.error('Error fetching data:', error);\n      }\n    };\n\n    fetchData();\n\n    const intervalId = setInterval(fetchData, 2000); // Refresh every 2 seconds\n\n    return () => clearInterval(intervalId); // Cleanup interval on unmount\n\n  }, []);\n\n\n  // Connect to WebSocket server\n  useEffect(() => {\n    const ws = new WebSocket('ws://localhost:4000');\n\n    console.log('WebSocket :', ws);\n\n    ws.onclose = () => {\n      console.log('WebSocket connection closed');\n    };\n\n    ws.onopen = () => {\n      console.log('WebSocket connection opened');\n    };\n\n    if (ws.readyState === WebSocket.CLOSED) {\n      console.log('WebSocket connection closed before it was established');\n    }\n\n    return () => {\n      ws.close();\n    };\n  }, []);\n\n  useEffect(() => {\n    const handleMessage = (event) => {\n      const data = JSON.parse(event.data);\n      setWebSocketData(data);\n      // console.log('set :',data)\n    };\n\n    if (webSocketData) {\n      const ws = new WebSocket('ws://localhost:4000');\n      ws.onmessage = handleMessage;\n\n      return () => {\n        ws.close();\n      };\n    }\n  }, [webSocketData]);\n\n\n  \n\n\n  return (\n    <div className=\"table-container\">\n      <img src={require('../assets/jastel.jpg')} alt=\"Jastel Logo\" />\n      <table className=\"table1\">\n        <thead className='TTH'>\n          <tr className='ab'>\n            {apiData && apiData.data.map(room => (\n              room.roomname !== \"SLG\" &&\n              room.roomname !== \"HYI3\" &&\n              room.roomname !== \"HYI4\" &&\n              room.roomname !== \"OFFICE7\" &&\n              room.roomname !== \"OFFICE6\" &&\n\n              <th key={room.roomname} className=\"room-name1\">{room.roomname}</th>\n            ))}\n          </tr>\n        </thead>\n        <tbody>\n          <tr className='bb'>\n            {apiData && apiData.data.map(room => (\n              room.roomname !== \"SLG\" &&\n              room.roomname !== \"HYI3\" &&\n              room.roomname !== \"HYI4\" &&\n              room.roomname !== \"OFFICE7\" &&\n              room.roomname !== \"OFFICE6\" &&\n\n              <td key={room.roomname}>\n\n                <table className=\"table2\">\n                  <tbody>\n                    {room.status.map((camera, index) => (\n                      <tr key={index}>\n                        <td\n                          className={`status-cell ${camera.camera === 'ON' ? 'status-on' : 'status-off'}`}\n                          title={camera.ip}\n                        >\n                          <a href={`http://${camera.ip}`} target=\"_blank\" rel=\"noopener noreferrer\">\n                            <div>{camera.camera}</div>\n                          </a>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n\n\n              </td>\n            ))}\n          </tr>\n        </tbody>\n      </table>\n\n\n\n\n      <table className='table3'>\n        <tbody>\n          {apiData && apiData.data\n            .filter(room => [\"SLG\", \"HYI3\", \"HYI4\", \"OFFICE7\", \"OFFICE6\"].includes(room.roomname))\n            .map(room => (\n              <tr key={room.roomname}>\n                <td className=\"room-name2\">{room.roomname}</td>\n                <td className=\"room-status\">\n\n                  <table className=\"table-4\">\n                    <tbody>\n                      <tr>\n                        {room.status.map((camera, index) => (\n                          <td key={index}\n                            className={`status-cell ${camera.camera === 'ON' ? 'status-on' : 'status-off'}`}\n                            title={camera.ip}>\n                            <a href={`http://${camera.ip}`} target=\"_blank\" rel=\"noopener noreferrer\">\n                              <div>{camera.camera}</div>\n                            </a>\n                          </td>\n                        ))}\n                      </tr>\n                    </tbody>\n                  </table>\n\n\n\n                </td>\n              </tr>\n            ))}\n        </tbody>\n      </table>\n\n    </div>\n  );\n\n};\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}