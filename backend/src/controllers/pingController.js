const ping = require('ping');

async function pingCctv(req,res) {



const rooms = {
    BPO: [
        '172.15.101.11',
        '172.15.101.12',
        '172.15.101.13',
        '172.15.101.14'
    ],
    WGW: [
        '172.15.102.11',
        '172.15.102.12',
        '172.15.102.13',
        '172.15.102.14'
    ],
    MTP: [
        '172.15.103.11',
        '172.15.103.12',
        '172.15.103.13',
        '172.15.103.14'
    ],
    NKM: [
        '172.15.104.11',
        '172.15.104.12',
        '172.15.104.13',
        '172.15.104.14'
    ],
    LKB: [
        '172.15.105.11',
        '172.15.105.12'
    ],
    NVNK: [
        '172.15.106.11',
        '172.15.106.12'
    ],
    ESIE: [
        '172.15.107.11',
        '172.15.107.12',
        '172.15.107.13'
    ],
    TSM: [
        '172.15.108.11',
        '172.15.108.12',
    ],
    QHE: [
        '172.15.109.11'
    ],
    RDC: [
        '172.15.110.11',
        '172.15.110.12'
    ],
    HBM: [
        '172.15.111.11',
        '172.15.111.12'
    ],
    VBVD: [
        '172.15.113.11',
        '172.15.113.12'
     ],
     RKH: [
        '172.15.114.11',
        '172.15.114.12'
    ],
    BMM: [
        '172.15.115.11',
        '172.15.115.12'
    ],
    TVN: [
        '172.15.116.11',
        '172.15.116.12'
    ],
    STN: [
        '172.15.117.11',
        '172.15.117.12'
    ],
    SNGR: [
        '172.15.118.11'
    ],
    UDS: [
        '172.15.119.11',
        '172.15.119.12'
    ],
    LSI: [
        '172.15.120.11',
        '172.15.120.12'
    ],
    SYN: [
        '172.15.121.11',
        '172.15.121.12'
    ],
    SWG: [
        '172.15.122.11',
        '172.15.122.12'
    ],
    RJN: [
        '172.15.123.11',
        '172.15.123.12'
    ],
    MDH: [
        '172.15.124.11',
        '172.15.124.12',
        '172.15.124.13'
    ],
    NKI: [
        '172.15.125.11',
        '172.15.125.12',
        '172.15.125.13'
    ],
    PNR: [
        '172.15.127.11',
        '172.15.127.12',
        '172.15.127.13'
    ],
    BPE: [
        '172.15.128.11',
        '172.15.128.12'
    ],
    KKW: [
        '172.15.129.11',
        '172.15.129.12'
    ],
    SMSK: [
        '172.15.130.11',
        '172.15.130.12'
    ],
    NKPN: [
        '172.15.131.11',
        '172.15.131.12'
    ],
    STP: [
        '172.15.132.11',
        '172.15.132.12'
    ],
    F6: [
        '172.15.133.11',
        '172.15.133.12'
    ],
    F7: [
        '172.15.134.11',
        '172.15.134.12'
    ],
    MST: [
        '172.15.135.11',
        '172.15.135.12',
        '172.15.135.12'
    ],
    MSI: [
        '172.15.136.11',
        '172.15.136.12',
        '172.15.136.12'
    ],
    CKG: [
        '172.15.137.11',
        '172.15.137.12',
        '172.15.137.12'
    ],
    BKE: [
        '172.15.138.11',
        '172.15.138.12'
    ],
    BYI: [
        '172.15.139.11',
        '172.15.139.12'
    ],
    STPD: [
        '172.15.140.11',
        '172.15.140.12'
    ],
    PKN: [
        '172.15.141.11',
        '172.15.141.12'
    ],
    KTB: [
        '172.15.142.11',
        '172.15.142.12'
    ],
    BKD: [
        '172.15.143.11',
        '172.15.143.12'
    ],
    ESIE2: [
        '172.15.144.11',
        '172.15.144.12'
    ],
    SMD: [
        '172.15.146.11',
        '172.15.146.12'
    ],
    SLG: [
        '172.15.149.50',
        '172.15.149.51',
        '172.15.149.52',
        '172.15.149.53',
        '172.15.149.54',
        '172.15.149.55',
        '172.15.149.56',
        '172.15.149.57',
        '172.15.149.58',
        '172.15.149.59',
        '172.15.149.60',
        '172.15.149.61',
        '172.15.149.62',
        '172.15.149.63',
        '172.15.149.64',
        '172.15.149.65',
        '172.15.149.66',
        '172.15.149.67',
        '172.15.149.68',
        '172.15.149.69',
        '172.15.149.70',
    ],
    TFD1: [
        '172.15.150.11',
        '172.15.150.12',
        '172.15.150.13'
    ],
    TFD2: [
        '172.15.151.11',
        '172.15.151.12',
        '172.15.151.13'
    ],
    PCSP: [
        '172.15.152.11',
        '172.15.152.12'
    ],
    SSW: [
        '172.15.153.11',
        '172.15.153.12'
    ],
    BBO: [
        '172.15.156.11',
        '172.15.156.12'
    ],
    BKI: [
        '172.15.157.11',
        '172.15.157.12',
        '172.15.157.13'

    ],
    AYT: [
        '172.15.159.11',
        '172.15.159.12',
        '172.15.159.13'
    ],
    TSE: [
        '172.15.160.11',
        '172.15.160.12'
    ],
    LME: [
        '172.15.161.11',
        '172.15.161.12'
    ],
    WNI: [
        '172.15.162.11',
        '172.15.162.12'
    ],
    KKS: [
        '172.15.163.11',
        '172.15.163.12'
    ],
    PTY1: [
        '172.15.164.11',
        '172.15.164.12'
    ],
    PTY2: [
        '172.15.165.11',
        '172.15.165.12'
    ],
    RST: [
        '172.15.166.11',
        '172.15.166.12'
    ],
    RBNA: [
        '172.15.167.11',
        '172.15.167.12'
    ],
    MBR: [
        '172.15.168.11',
        '172.15.168.12'
    ],
    RDA: [
        '172.15.169.11',
        '172.15.169.12'
    ],
    BBG: [
        '172.15.171.11',
        '172.15.171.12'
    ],
    HYI3: [
        '172.17.26.30',
        '172.17.26.31',
        '172.17.26.32',
        '172.17.26.33',
        '172.17.26.34',
        '172.17.26.35',
        '172.17.26.36',
        '172.17.26.37',
        '172.17.26.38',
        '172.17.26.39',
        '172.17.26.40',
        '172.17.26.41',
        '172.17.26.42',
        '172.17.26.43',
        '172.17.26.44',
        '172.17.26.45',
        '172.17.26.46',
        '172.17.26.60',        
        '172.17.26.61',
        '172.17.26.62',
        '172.17.26.63',
        '172.17.26.64'
    ],
    HYI4: [
        '172.17.26.66',
        '172.17.26.67',
        '172.17.26.68', 
        '172.17.26.69',
        '172.17.26.70',
        '172.17.26.71',
        '172.17.26.72', 
    ],
    OFFICE7: [
        '172.16.15.32',
        '172.16.15.33',        
        '172.16.15.34',
        '172.16.15.35',
        '172.16.15.36',
        '172.16.15.37',
        '172.16.15.38',
        '172.16.15.39'
    ],
    OFFICE6: [
        '172.16.13.31',
        '172.16.13.32',
        '172.16.13.33',
        '172.16.13.34',
        '172.16.13.35'
    ]
};

try {
    const results1 = await Promise.all(
        Object.entries(rooms).map(async ([room, ipAddresses]) => {
            const roomStatus = await Promise.all(
                ipAddresses.map(async ip => {
                    const response = await ping.promise.probe(ip);
                    return { ip, camera: response.alive ? 'ON' : 'OFF' };
                })
            );
            return { roomname: room, status: roomStatus };
        })
    );

    res.status(200).json({
        success: true,
        message: "OK",
        results: results1.length,
        data: results1
    });
} catch (error) {
    console.error('Error:', error);
    res.status(500).json({ error: 'Ping cctv error' });
}

}

module.exports = {pingCctv};